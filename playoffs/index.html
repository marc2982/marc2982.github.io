<html lang="en">
<head>
    <title>Bryan Family Playoff Pools</title>
    <link href="css/index.css" rel="stylesheet" />
    <link href="css/teams.css" rel="stylesheet" />
    <link href="css/tables.css" rel="stylesheet" />

    <script src="js/yearlyResults.js" type="module"></script>
    <script src="js/winsLosses.js" type="module"></script>

    <script src="https://code.jquery.com/jquery-3.7.1.slim.min.js"></script>
    <script src="https://cdn.datatables.net/2.0.8/js/dataTables.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdn.datatables.net/2.0.8/css/dataTables.dataTables.css" rel="stylesheet" />


</head>
<body>
	<div id="container">
		<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
			<h1 id="pageHeader" style="margin-bottom: 0;">Bryan Family Playoff Pools</h1>
			<a href="picks.html" style="background: #0033a0; color: white; padding: 10px 20px; text-decoration: none; border-radius: 20px; font-weight: bold; font-family: sans-serif;">Make Picks!</a>
		</div>
		
		<!-- Tab Navigation -->
		<div class="tab-nav">
			<button class="tab-button active" data-tab="results">Results</button>
			<button class="tab-button" data-tab="performance">Performance</button>
			<button class="tab-button" data-tab="picks">Pick Analysis</button>
			<button class="tab-button" data-tab="rounds">Round Analysis</button>
			<button class="tab-button" data-tab="teams">Team Analysis</button>
			<button class="tab-button" data-tab="h2h">Head-to-Head</button>
		</div>

		<!-- Tab Content -->
		<div id="results" class="tab-content active">
			<div class="section-card">
				<h2>Yearly Results</h2>
				<table id="yearlyResults" class="stripe"></table>
			</div>
			<div class="section-card">
				<h2>Wins & Losses</h2>
				<table id="winsLosses" class="stripe"></table>
			</div>
		</div>

		<div id="performance" class="tab-content">
			<div class="loading-spinner" style="text-align:center; padding: 20px; font-style: italic; color: #666;">Loading performance stats...</div>
		</div>

		<div id="picks" class="tab-content">
			<div class="loading-spinner" style="text-align:center; padding: 20px; font-style: italic; color: #666;">Loading pick analysis...</div>
		</div>

		<div id="rounds" class="tab-content">
			<div class="loading-spinner" style="text-align:center; padding: 20px; font-style: italic; color: #666;">Loading round analysis...</div>
		</div>

		<div id="teams" class="tab-content">
			<div class="loading-spinner" style="text-align:center; padding: 20px; font-style: italic; color: #666;">Loading team analysis...</div>
		</div>

		<div id="h2h" class="tab-content">
			<div class="loading-spinner" style="text-align:center; padding: 20px; font-style: italic; color: #666;">Loading head-to-head stats...</div>
		</div>
	</div>

	<script type="module">
		import { yearlyResults } from './js/yearlyResults.js';
		import { winsLosses } from './js/winsLosses.js';
		import { performanceStats } from './js/performanceStats.js';
		import { pickAnalysis } from './js/pickAnalysis.js';
		import { roundAnalysis } from './js/roundAnalysis.js';
		import { teamAnalysis } from './js/teamAnalysis.js';
		import { headToHead } from './js/headToHead.js';

		// Initialize tabs immediately
		$('.tab-button').on('click', function() {
			const tabName = $(this).data('tab');

			// Update active tab button
			$('.tab-button').removeClass('active');
			$(this).addClass('active');

			// Update active tab content
			$('.tab-content').removeClass('active');
			$('#' + tabName).addClass('active');
		});

		window.onload = async function() {
			// Trigger all data loads in parallel
			// The functions clear their containers when data is ready.
			// Until then, the spinners defined in HTML remain visible.
			Promise.all([
				yearlyResults($('#yearlyResults')),
				winsLosses($('#winsLosses')),
				performanceStats($('#performance')),
				pickAnalysis($('#picks')),
				roundAnalysis($('#rounds')),
				teamAnalysis($('#teams')),
				headToHead($('#h2h'))
			]).catch(err => console.error("Error loading analytics:", err));
		}
	</script>
</body>
</html>
